Model:
HDemucs(
  (freq_encoder): ModuleList(
    (0): _HEncLayer(
      (conv): Conv2d(4, 48, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
      (norm1): Identity()
      (rewrite): Conv2d(48, 96, kernel_size=(1, 1), stride=(1, 1))
      (norm2): Identity()
      (dconv): _DConv(
        (layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(48, 12, kernel_size=(3,), stride=(1,), padding=(1,))
            (1): GroupNorm(1, 12, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(12, 96, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 96, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
          (1): Sequential(
            (0): Conv1d(48, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
            (1): GroupNorm(1, 12, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(12, 96, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 96, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
        )
      )
    )
    (1): _HEncLayer(
      (conv): Conv2d(48, 96, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
      (norm1): Identity()
      (rewrite): Conv2d(96, 192, kernel_size=(1, 1), stride=(1, 1))
      (norm2): Identity()
      (dconv): _DConv(
        (layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(96, 24, kernel_size=(3,), stride=(1,), padding=(1,))
            (1): GroupNorm(1, 24, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(24, 192, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 192, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
          (1): Sequential(
            (0): Conv1d(96, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
            (1): GroupNorm(1, 24, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(24, 192, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 192, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
        )
      )
    )
    (2): _HEncLayer(
      (conv): Conv2d(96, 192, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
      (norm1): Identity()
      (rewrite): Conv2d(192, 384, kernel_size=(1, 1), stride=(1, 1))
      (norm2): Identity()
      (dconv): _DConv(
        (layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(192, 48, kernel_size=(3,), stride=(1,), padding=(1,))
            (1): GroupNorm(1, 48, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(48, 384, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 384, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
          (1): Sequential(
            (0): Conv1d(192, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
            (1): GroupNorm(1, 48, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(48, 384, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 384, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
        )
      )
    )
    (3): _HEncLayer(
      (conv): Conv2d(192, 384, kernel_size=(8, 1), stride=(4, 1), padding=(2, 0))
      (norm1): Identity()
      (rewrite): Conv2d(384, 768, kernel_size=(1, 1), stride=(1, 1))
      (norm2): Identity()
      (dconv): _DConv(
        (layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(384, 96, kernel_size=(3,), stride=(1,), padding=(1,))
            (1): GroupNorm(1, 96, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(96, 768, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 768, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
          (1): Sequential(
            (0): Conv1d(384, 96, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
            (1): GroupNorm(1, 96, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(96, 768, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 768, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
        )
      )
    )
    (4): _HEncLayer(
      (conv): Conv2d(384, 768, kernel_size=(8, 1), stride=(4, 1))
      (norm1): GroupNorm(4, 768, eps=1e-05, affine=True)
      (rewrite): Conv2d(768, 1536, kernel_size=(1, 1), stride=(1, 1))
      (norm2): GroupNorm(4, 1536, eps=1e-05, affine=True)
      (dconv): _DConv(
        (layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(768, 192, kernel_size=(3,), stride=(1,), padding=(1,))
            (1): GroupNorm(1, 192, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): _BLSTM(
              (lstm): LSTM(192, 192, num_layers=2, bidirectional=True)
              (linear): Linear(in_features=384, out_features=192, bias=True)
            )
            (4): _LocalState(
              (content): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
              (query): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
              (key): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
              (query_decay): Conv1d(192, 16, kernel_size=(1,), stride=(1,))
              (proj): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
            )
            (5): Conv1d(192, 1536, kernel_size=(1,), stride=(1,))
            (6): GroupNorm(1, 1536, eps=1e-05, affine=True)
            (7): GLU(dim=1)
            (8): _LayerScale()
          )
          (1): Sequential(
            (0): Conv1d(768, 192, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
            (1): GroupNorm(1, 192, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): _BLSTM(
              (lstm): LSTM(192, 192, num_layers=2, bidirectional=True)
              (linear): Linear(in_features=384, out_features=192, bias=True)
            )
            (4): _LocalState(
              (content): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
              (query): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
              (key): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
              (query_decay): Conv1d(192, 16, kernel_size=(1,), stride=(1,))
              (proj): Conv1d(192, 192, kernel_size=(1,), stride=(1,))
            )
            (5): Conv1d(192, 1536, kernel_size=(1,), stride=(1,))
            (6): GroupNorm(1, 1536, eps=1e-05, affine=True)
            (7): GLU(dim=1)
            (8): _LayerScale()
          )
        )
      )
    )
    (5): _HEncLayer(
      (conv): Conv1d(768, 1536, kernel_size=(4,), stride=(2,), padding=(1,))
      (norm1): GroupNorm(4, 1536, eps=1e-05, affine=True)
      (rewrite): Conv1d(1536, 3072, kernel_size=(1,), stride=(1,))
      (norm2): GroupNorm(4, 3072, eps=1e-05, affine=True)
      (dconv): _DConv(
        (layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(1536, 384, kernel_size=(3,), stride=(1,), padding=(1,))
            (1): GroupNorm(1, 384, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): _BLSTM(
              (lstm): LSTM(384, 384, num_layers=2, bidirectional=True)
              (linear): Linear(in_features=768, out_features=384, bias=True)
            )
            (4): _LocalState(
              (content): Conv1d(384, 384, kernel_size=(1,), stride=(1,))
              (query): Conv1d(384, 384, kernel_size=(1,), stride=(1,))
              (key): Conv1d(384, 384, kernel_size=(1,), stride=(1,))
              (query_decay): Conv1d(384, 16, kernel_size=(1,), stride=(1,))
              (proj): Conv1d(384, 384, kernel_size=(1,), stride=(1,))
            )
            (5): Conv1d(384, 3072, kernel_size=(1,), stride=(1,))
            (6): GroupNorm(1, 3072, eps=1e-05, affine=True)
            (7): GLU(dim=1)
            (8): _LayerScale()
          )
          (1): Sequential(
            (0): Conv1d(1536, 384, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
            (1): GroupNorm(1, 384, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): _BLSTM(
              (lstm): LSTM(384, 384, num_layers=2, bidirectional=True)
              (linear): Linear(in_features=768, out_features=384, bias=True)
            )
            (4): _LocalState(
              (content): Conv1d(384, 384, kernel_size=(1,), stride=(1,))
              (query): Conv1d(384, 384, kernel_size=(1,), stride=(1,))
              (key): Conv1d(384, 384, kernel_size=(1,), stride=(1,))
              (query_decay): Conv1d(384, 16, kernel_size=(1,), stride=(1,))
              (proj): Conv1d(384, 384, kernel_size=(1,), stride=(1,))
            )
            (5): Conv1d(384, 3072, kernel_size=(1,), stride=(1,))
            (6): GroupNorm(1, 3072, eps=1e-05, affine=True)
            (7): GLU(dim=1)
            (8): _LayerScale()
          )
        )
      )
    )
  )
  (freq_decoder): ModuleList(
    (0): _HDecLayer(
      (conv_tr): ConvTranspose1d(1536, 768, kernel_size=(4,), stride=(2,))
      (norm2): GroupNorm(4, 768, eps=1e-05, affine=True)
      (rewrite): Conv1d(1536, 3072, kernel_size=(3,), stride=(1,), padding=(1,))
      (norm1): GroupNorm(4, 3072, eps=1e-05, affine=True)
    )
    (1): _HDecLayer(
      (conv_tr): ConvTranspose2d(768, 384, kernel_size=(8, 1), stride=(4, 1))
      (norm2): GroupNorm(4, 384, eps=1e-05, affine=True)
      (rewrite): Conv2d(768, 1536, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (norm1): GroupNorm(4, 1536, eps=1e-05, affine=True)
    )
    (2): _HDecLayer(
      (conv_tr): ConvTranspose2d(384, 192, kernel_size=(8, 1), stride=(4, 1))
      (norm2): Identity()
      (rewrite): Conv2d(384, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (norm1): Identity()
    )
    (3): _HDecLayer(
      (conv_tr): ConvTranspose2d(192, 96, kernel_size=(8, 1), stride=(4, 1))
      (norm2): Identity()
      (rewrite): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (norm1): Identity()
    )
    (4): _HDecLayer(
      (conv_tr): ConvTranspose2d(96, 48, kernel_size=(8, 1), stride=(4, 1))
      (norm2): Identity()
      (rewrite): Conv2d(96, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (norm1): Identity()
    )
    (5): _HDecLayer(
      (conv_tr): ConvTranspose2d(48, 16, kernel_size=(8, 1), stride=(4, 1))
      (norm2): Identity()
      (rewrite): Conv2d(48, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (norm1): Identity()
    )
  )
  (time_encoder): ModuleList(
    (0): _HEncLayer(
      (conv): Conv1d(2, 48, kernel_size=(8,), stride=(4,), padding=(2,))
      (norm1): Identity()
      (rewrite): Conv1d(48, 96, kernel_size=(1,), stride=(1,))
      (norm2): Identity()
      (dconv): _DConv(
        (layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(48, 12, kernel_size=(3,), stride=(1,), padding=(1,))
            (1): GroupNorm(1, 12, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(12, 96, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 96, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
          (1): Sequential(
            (0): Conv1d(48, 12, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
            (1): GroupNorm(1, 12, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(12, 96, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 96, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
        )
      )
    )
    (1): _HEncLayer(
      (conv): Conv1d(48, 96, kernel_size=(8,), stride=(4,), padding=(2,))
      (norm1): Identity()
      (rewrite): Conv1d(96, 192, kernel_size=(1,), stride=(1,))
      (norm2): Identity()
      (dconv): _DConv(
        (layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(96, 24, kernel_size=(3,), stride=(1,), padding=(1,))
            (1): GroupNorm(1, 24, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(24, 192, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 192, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
          (1): Sequential(
            (0): Conv1d(96, 24, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
            (1): GroupNorm(1, 24, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(24, 192, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 192, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
        )
      )
    )
    (2): _HEncLayer(
      (conv): Conv1d(96, 192, kernel_size=(8,), stride=(4,), padding=(2,))
      (norm1): Identity()
      (rewrite): Conv1d(192, 384, kernel_size=(1,), stride=(1,))
      (norm2): Identity()
      (dconv): _DConv(
        (layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(192, 48, kernel_size=(3,), stride=(1,), padding=(1,))
            (1): GroupNorm(1, 48, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(48, 384, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 384, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
          (1): Sequential(
            (0): Conv1d(192, 48, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
            (1): GroupNorm(1, 48, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(48, 384, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 384, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
        )
      )
    )
    (3): _HEncLayer(
      (conv): Conv1d(192, 384, kernel_size=(8,), stride=(4,), padding=(2,))
      (norm1): Identity()
      (rewrite): Conv1d(384, 768, kernel_size=(1,), stride=(1,))
      (norm2): Identity()
      (dconv): _DConv(
        (layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(384, 96, kernel_size=(3,), stride=(1,), padding=(1,))
            (1): GroupNorm(1, 96, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(96, 768, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 768, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
          (1): Sequential(
            (0): Conv1d(384, 96, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
            (1): GroupNorm(1, 96, eps=1e-05, affine=True)
            (2): GELU(approximate='none')
            (3): Conv1d(96, 768, kernel_size=(1,), stride=(1,))
            (4): GroupNorm(1, 768, eps=1e-05, affine=True)
            (5): GLU(dim=1)
            (6): _LayerScale()
          )
        )
      )
    )
    (4): _HEncLayer(
      (conv): Conv1d(384, 768, kernel_size=(8,), stride=(4,), padding=(2,))
      (norm1): GroupNorm(4, 768, eps=1e-05, affine=True)
      (rewrite): Identity()
      (norm2): Identity()
      (dconv): Identity()
    )
  )
  (time_decoder): ModuleList(
    (0): _HDecLayer(
      (conv_tr): ConvTranspose1d(768, 384, kernel_size=(8,), stride=(4,))
      (norm2): GroupNorm(4, 384, eps=1e-05, affine=True)
      (rewrite): Identity()
      (norm1): Identity()
    )
    (1): _HDecLayer(
      (conv_tr): ConvTranspose1d(384, 192, kernel_size=(8,), stride=(4,))
      (norm2): Identity()
      (rewrite): Conv1d(384, 768, kernel_size=(3,), stride=(1,), padding=(1,))
      (norm1): Identity()
    )
    (2): _HDecLayer(
      (conv_tr): ConvTranspose1d(192, 96, kernel_size=(8,), stride=(4,))
      (norm2): Identity()
      (rewrite): Conv1d(192, 384, kernel_size=(3,), stride=(1,), padding=(1,))
      (norm1): Identity()
    )
    (3): _HDecLayer(
      (conv_tr): ConvTranspose1d(96, 48, kernel_size=(8,), stride=(4,))
      (norm2): Identity()
      (rewrite): Conv1d(96, 192, kernel_size=(3,), stride=(1,), padding=(1,))
      (norm1): Identity()
    )
    (4): _HDecLayer(
      (conv_tr): ConvTranspose1d(48, 8, kernel_size=(8,), stride=(4,))
      (norm2): Identity()
      (rewrite): Conv1d(48, 96, kernel_size=(3,), stride=(1,), padding=(1,))
      (norm1): Identity()
    )
  )
  (freq_emb): _ScaledEmbedding(
    (embedding): Embedding(512, 48)
  )
)
Sample rate: 44100
Separating track
Mix shape: torch.Size([1, 2, 7560512])
Mixed spectrogram size: torch.Size([2049, 110251])
